<div class="reminders-container">
  <div class="header">
    <h1>Reminders</h1>
    <button class="btn btn-primary" (click)="showAddForm = !showAddForm">
      {{ showAddForm ? 'Cancel' : 'Add New Reminder' }}
    </button>
  </div>

  <!-- Add Reminder Form -->
  <div class="form-container" *ngIf="showAddForm">
    <h2>{{ editingReminder ? 'Edit Reminder' : 'Add New Reminder' }}</h2>
    <form (ngSubmit)="saveReminder()" #reminderForm="ngForm">
      <div class="form-row">
        <div class="form-group">
          <label for="title">Title *</label>
          <input type="text" id="title" [(ngModel)]="currentReminder.title" name="title" 
                 placeholder="Enter reminder title..." required>
        </div>

        <div class="form-group">
          <label for="type">Type *</label>
          <select id="type" [(ngModel)]="currentReminder.type" name="type" required>
            <option value="">Select type</option>
            <option value="vaccination">Vaccination</option>
            <option value="medication">Medication</option>
            <option value="appointment">Appointment</option>
            <option value="grooming">Grooming</option>
            <option value="checkup">Checkup</option>
            <option value="other">Other</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="reminderDate">Reminder Date *</label>
          <input type="date" id="reminderDate" [(ngModel)]="currentReminder.reminderDate" name="reminderDate" required>
        </div>

        <div class="form-group">
          <label for="owner">Owner *</label>
          <select id="owner" [(ngModel)]="currentReminder.owner" name="owner" required>
            <option value="">Select owner</option>
            <option *ngFor="let owner of owners" [ngValue]="owner">{{ owner.name }}</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="message">Message *</label>
        <textarea id="message" [(ngModel)]="currentReminder.message" name="message" rows="3" 
                  placeholder="Enter reminder message..." required></textarea>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="!reminderForm.form.valid">
          {{ editingReminder ? 'Update Reminder' : 'Add Reminder' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelForm()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Filter Controls -->
  <div class="filter-container">
    <div class="filter-group">
      <label for="statusFilter">Filter by Status:</label>
      <select id="statusFilter" [(ngModel)]="selectedStatus" (ngModelChange)="filterReminders()">
        <option value="">All Reminders</option>
        <option value="pending">Pending</option>
        <option value="completed">Completed</option>
      </select>
    </div>
    
    <div class="filter-group">
      <label for="typeFilter">Filter by Type:</label>
      <select id="typeFilter" [(ngModel)]="selectedType" (ngModelChange)="filterReminders()">
        <option value="">All Types</option>
        <option value="vaccination">Vaccination</option>
        <option value="medication">Medication</option>
        <option value="appointment">Appointment</option>
        <option value="grooming">Grooming</option>
        <option value="checkup">Checkup</option>
        <option value="other">Other</option>
      </select>
    </div>
  </div>

  <!-- Urgent Reminders -->
  <div class="urgent-reminders" *ngIf="urgentReminders.length > 0">
    <h3>ðŸš¨ Urgent Reminders (Due Soon)</h3>
    <div class="urgent-grid">
      <div class="urgent-card" *ngFor="let reminder of urgentReminders">
        <div class="urgent-header">
          <h4>{{ reminder.title }}</h4>
          <span class="type-badge" [class]="'type-' + reminder.type">{{ reminder.type | titlecase }}</span>
        </div>
        <p class="urgent-date">Due: {{ reminder.reminderDate | date:'short' }}</p>
        <p class="urgent-message">{{ reminder.message }}</p>
        <div class="urgent-actions">
          <button class="btn btn-sm btn-success" (click)="markComplete(reminder.id!)">Mark Complete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Reminders List -->
  <div class="reminders-grid">
    <div class="reminder-card" *ngFor="let reminder of filteredReminders" 
         [class.completed]="reminder.status === 'completed'"
         [class.overdue]="isOverdue(reminder)">
      
      <div class="reminder-header">
        <div class="reminder-info">
          <h3>{{ reminder.title }}</h3>
          <span class="type-badge" [class]="'type-' + reminder.type">{{ reminder.type | titlecase }}</span>
        </div>
        <div class="reminder-actions">
          <button class="btn btn-sm btn-secondary" (click)="editReminder(reminder)" *ngIf="reminder.status !== 'completed'">Edit</button>
          <button class="btn btn-sm btn-danger" (click)="deleteReminder(reminder.id!)">Delete</button>
        </div>
      </div>

      <div class="reminder-details">
        <div class="detail-item">
          <strong>Owner:</strong> {{ reminder.owner?.name }}
        </div>
        <div class="detail-item">
          <strong>Date:</strong> {{ reminder.reminderDate | date:'fullDate' }}
        </div>
        <div class="detail-item">
          <strong>Status:</strong> 
          <span class="status-badge" [class]="'status-' + reminder.status">
            {{ reminder.status | titlecase }}
          </span>
        </div>
        <div class="detail-item">
          <strong>Message:</strong>
          <p class="message">{{ reminder.message }}</p>
        </div>
      </div>

      <div class="reminder-bottom" *ngIf="reminder.status === 'pending'">
        <button class="btn btn-success" (click)="markComplete(reminder.id!)">
          Mark as Complete
        </button>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="filteredReminders.length === 0">
    <div class="empty-icon">ðŸ””</div>
    <h3>No reminders found</h3>
    <p *ngIf="selectedStatus || selectedType">No reminders match the selected filters.</p>
    <p *ngIf="!selectedStatus && !selectedType">No reminders have been created yet.</p>
    <button class="btn btn-primary" (click)="showAddForm = true">Create Your First Reminder</button>
  </div>
</div>
